import{i as A,u as f,r as a,j as e}from"./vendor-react-DtsOz5pv.js";import{a as m,C as j,I as E,E as H,b as n,O as L}from"./components-shared-yLUaqag5.js";import{e as T}from"./feature-pharmacy-DnTWHjw-.js";import"./vendor-other-DG8If0Tp.js";import{f as g}from"./vendor-utils-DvtxXjqu.js";import"./vendor-redux-CxpqfPS-.js";import"./vendor-ui-B-dksMZM.js";function Q(){const N=A(),{prescriptions:b}=f(s=>s.prescriptions),{user:d}=f(s=>s.auth),[i,y]=a.useState(""),[r,v]=a.useState("all"),[c,w]=a.useState(!1),[u,R]=a.useState(null),[S,h]=a.useState(!1),l=b.filter(s=>s.doctorName===(d==null?void 0:d.name)||!0),p=l.filter(s=>{const t=s.patientName.toLowerCase().includes(i.toLowerCase())||s.medications.some(M=>M.name.toLowerCase().includes(i.toLowerCase())),x=r==="all"||s.status===r,D=!c||s.refillRequested;return t&&x&&D}),o=l.filter(s=>s.refillRequested).length,q=s=>{N(L(s))},P=s=>{R(s),h(!0)},C=s=>{switch(s){case"dispensed":return e.jsx(n,{status:"delivered",children:"Dispensed"});case"ready":return e.jsx(n,{status:"sent",children:"Ready"});case"processing":return e.jsx(n,{status:"pending",children:"Processing"});default:return e.jsx(n,{status:"request",children:"Pending"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Prescription History"}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"View and manage patient prescriptions"})]}),o>0&&e.jsxs(m,{onClick:()=>w(!c),className:"flex items-center gap-2",children:[e.jsx("span",{className:"bg-error text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:o}),c?"Show All":"Refill Requests"]})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx(E,{placeholder:"Search by patient or medication...",value:i,onChange:s=>y(s.target.value),className:"flex-1"}),e.jsxs("select",{value:r,onChange:s=>v(s.target.value),className:"px-3 py-2 border border-neutral-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"ready",children:"Ready"}),e.jsx("option",{value:"dispensed",children:"Dispensed"})]})]}),p.length===0?e.jsx(H,{icon:"ðŸ“‹",title:"No prescriptions found",description:i||r!=="all"||c?"Try adjusting your filters":"Prescriptions you write will appear here"}):e.jsx("div",{className:"space-y-4",children:p.map(s=>e.jsxs("div",{className:`p-4 border-2 rounded-lg transition-all ${s.refillRequested?"border-warning-300 bg-warning-50":"border-neutral-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-base font-semibold text-neutral-900",children:s.patientName}),s.refillRequested&&e.jsx(n,{status:"pending",children:"Refill Requested"})]}),e.jsxs("p",{className:"text-sm text-neutral-600",children:["Prescription #",s.id," â€¢ ",g(new Date(s.prescriptionDate),"MMM dd, yyyy HH:mm")]})]}),C(s.status)]}),e.jsx("div",{className:"space-y-2 mb-3",children:s.medications.map((t,x)=>e.jsxs("div",{className:"flex justify-between items-start p-3 bg-white rounded-lg border border-neutral-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-neutral-900",children:t.name}),e.jsxs("p",{className:"text-xs text-neutral-600",children:[t.dosage," â€¢ ",t.frequency," â€¢ ",t.duration]}),t.instructions&&e.jsx("p",{className:"text-xs text-neutral-500 mt-1 italic",children:t.instructions})]}),e.jsxs("p",{className:"text-sm text-neutral-600",children:["Qty: ",t.quantity]})]},x))}),s.notes&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg mb-3",children:[e.jsx("p",{className:"text-xs text-neutral-600 mb-1",children:"Clinical Notes"}),e.jsx("p",{className:"text-sm text-neutral-900",children:s.notes})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-neutral-200",children:[e.jsxs("div",{className:"text-xs text-neutral-600",children:[s.refillsRemaining!==void 0&&e.jsxs("span",{children:["Refills remaining: ",s.refillsRemaining]}),s.refillRequestDate&&e.jsxs("span",{className:"ml-4",children:["Requested: ",g(new Date(s.refillRequestDate),"MMM dd, yyyy")]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.refillRequested&&e.jsx(m,{size:"sm",onClick:()=>q(s.id),children:"Approve Refill"}),e.jsx(m,{variant:"secondary",size:"sm",onClick:()=>P(s),children:"View Full Details"})]})]})]},s.id))})]}),e.jsxs(j,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-primary-50 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-semibold text-primary-700",children:l.length}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Total Prescriptions"})]}),e.jsxs("div",{className:"text-center p-4 bg-warning-50 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-semibold text-warning-700",children:o}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Refill Requests"})]}),e.jsxs("div",{className:"text-center p-4 bg-success-50 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-semibold text-success-700",children:l.filter(s=>s.status==="dispensed").length}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Dispensed"})]}),e.jsxs("div",{className:"text-center p-4 bg-neutral-100 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-semibold text-neutral-700",children:l.filter(s=>s.status==="pending").length}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Pending"})]})]})]}),u&&e.jsx(T,{isOpen:S,onClose:()=>h(!1),prescription:u})]})}export{Q as PrescriptionHistory};
